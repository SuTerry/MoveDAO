{"version":3,"file":"js/src_views_Detail_index_tsx.4d358548.js","mappings":"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","sources":["webpack://react/./src/views/Detail/index.tsx"],"sourcesContent":["import React, { useEffect, useState } from 'react'\r\n\r\nimport { Button } from '@mui/material'\r\n\r\nimport { useNavigate, useParams } from 'react-router-dom'\r\n\r\nimport dayjs from 'dayjs'\r\n\r\nimport message from '@components/Message'\r\n\r\nimport { proposalsApi } from '@api/index'\r\n\r\nimport { ProsposalResponse } from '@api/proposals'\r\n\r\nimport { truncateMiddle, percentage } from '@utils/index'\r\n\r\nimport './index.less'\r\n\r\nexport default (): JSX.Element => {\r\n\r\n  const [proposals, setProposals] = useState<ProsposalResponse>()\r\n\r\n  const [total, setTotal] = useState(0)\r\n\r\n  const navigate = useNavigate()\r\n\r\n  const { id = '', handle = '' } = useParams()\r\n\r\n  const getDetailData = async () => {\r\n    try {\r\n      const res = await proposalsApi.getProsposal(id, handle)\r\n      setProposals(res)\r\n    } catch (error) {\r\n\r\n    }\r\n  }\r\n\r\n  const handleVote = (type: number): void => {\r\n    proposalsApi.vote([parseInt(id), 1, type]).then(() => {\r\n      message.success('投票成功')\r\n      getDetailData()\r\n    })\r\n  }\r\n\r\n  useEffect(() => {\r\n    getDetailData()\r\n  }, [])\r\n\r\n  useEffect(() => {\r\n    if (proposals) setTotal(parseInt(proposals.yes_votes) + parseInt(proposals.no_votes) + parseInt(proposals.abstained_votes))\r\n  }, [proposals])\r\n\r\n  return (\r\n    <div className='detail'>\r\n      <div className=\"detail_back\">\r\n        <Button\r\n          variant=\"contained\"\r\n          sx={{\r\n            width: 100,\r\n          }}\r\n          onClick={() => navigate('/list')}>\r\n          返回\r\n        </Button>\r\n      </div>\r\n\r\n      {\r\n        proposals && (\r\n          <div className=\"detail_container\">\r\n            <div className=\"detail_container_top\">\r\n              <div className=\"d_c_t_left\">\r\n                <div className=\"d_c_t_l_title\">{proposals.title}</div>\r\n                <div className=\"d_c_t_l_sub_title\">\r\n                  <div className=\"d_c_t_l_s_resolved\">{proposals.is_resolved ? '已结束' : '进行中'}</div>\r\n                  <div className=\"d_c_t_l_s_proposer\">{truncateMiddle(proposals.proposer, 3, 3)} 发起</div>\r\n                </div>\r\n                <div className=\"d_c_t_l_description\">\r\n                  <div className=\"d_c_t_l_d_title\">提案内容</div>\r\n                  <div className=\"d_c_t_l_d_content\">\r\n                    <div className=\"d_c_t_l_d_c_html\" dangerouslySetInnerHTML={{ __html: proposals.description }}></div>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n              <div className=\"d_c_t_right\">\r\n                <div className=\"d_v_t_r_date\">\r\n                  <div className=\"d_v_t_r_d_left\">\r\n                    <div className=\"d_v_t_r_d_l_title\">开始投票日期</div>\r\n                    <div className=\"d_v_t_r_d_l_date\">{dayjs(parseInt(proposals.start_time)).format('MM/DD/YYYY')}</div>\r\n                  </div>\r\n                  <div className=\"d_v_t_r_d_right\">\r\n                    <div className=\"d_v_t_r_d_r_title\">结束投票日期</div>\r\n                    <div className=\"d_v_t_r_d_r_date\">{dayjs(parseInt(proposals.end_time)).format('MM/DD/YYYY')}</div>\r\n                  </div>\r\n                </div>\r\n                <div className=\"d_v_t_r_bottom\">\r\n                  <div className=\"d_v_t_r_b_title\">投票结果</div>\r\n                  <div className=\"d_v_t_r_b_votes\">\r\n                    <div className=\"d_v_t_r_b_v_title\">\r\n                      <div className=\"d_v_t_r_b_v_t_left\">支持</div>\r\n                      <div className=\"d_v_t_r_b_v_t_left\">{`${proposals.yes_votes}积分 ${percentage(parseInt(proposals.yes_votes), total)}%`}</div>\r\n                    </div>\r\n                    <div className=\"d_v_t_r_b_v_slider\">\r\n                      <div className=\"d_v_t_r_b_v_s_cover\" style={{ width: `${percentage(parseInt(proposals.yes_votes), total)}%` }}></div>\r\n                    </div>\r\n                  </div>\r\n                  <div className=\"d_v_t_r_b_votes\">\r\n                    <div className=\"d_v_t_r_b_v_title\">\r\n                      <div className=\"d_v_t_r_b_v_t_left\">反对</div>\r\n                      <div className=\"d_v_t_r_b_v_t_left\">{`${proposals.no_votes}积分 ${percentage(parseInt(proposals.no_votes), total)}%`}</div>\r\n                    </div>\r\n                    <div className=\"d_v_t_r_b_v_slider\">\r\n                      <div className=\"d_v_t_r_b_v_s_cover\" style={{ width: `${percentage(parseInt(proposals.no_votes), total)}%` }}></div>\r\n                    </div>\r\n                  </div>\r\n                  <div className=\"d_v_t_r_b_votes\">\r\n                    <div className=\"d_v_t_r_b_v_title\">\r\n                      <div className=\"d_v_t_r_b_v_t_left\">弃权</div>\r\n                      <div className=\"d_v_t_r_b_v_t_left\">{`${proposals.abstained_votes}积分 ${percentage(parseInt(proposals.abstained_votes), total)}%`}</div>\r\n                    </div>\r\n                    <div className=\"d_v_t_r_b_v_slider\">\r\n                      <div className=\"d_v_t_r_b_v_s_cover\" style={{ width: `${percentage(parseInt(proposals.abstained_votes), total)}%` }}></div>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n            <div className=\"detail_container_bottom\">\r\n              <div className=\"d_c_b_left\">\r\n                <div className=\"d_c_b_l_title\">投票详情</div>\r\n                <ul className=\"d_c_b_l_content\">\r\n                  <li></li>\r\n                </ul>\r\n                <div className=\"d_c_b_l_button\">\r\n                  <Button\r\n                    variant=\"contained\"\r\n                    disabled\r\n                    sx={{\r\n                      width: 100,\r\n                    }}\r\n                    onClick={() => navigate('/list')}>\r\n                    显示更多\r\n                  </Button>\r\n                </div>\r\n              </div>\r\n              <div className=\"d_c_b_right\">\r\n                <div className=\"d_c_b_r_title\">投票</div>\r\n                <div className=\"d_c_b_r_bottons\">\r\n                  <Button\r\n                    variant=\"contained\"\r\n                    sx={{\r\n                      width: 100,\r\n                    }}\r\n                    onClick={() => handleVote(1)}>\r\n                    支持\r\n                  </Button>\r\n                  <Button\r\n                    variant=\"contained\"\r\n                    sx={{\r\n                      width: 100,\r\n                    }}\r\n                    onClick={() => handleVote(2)}>\r\n                    反对\r\n                  </Button>\r\n                  <Button\r\n                    variant=\"contained\"\r\n                    sx={{\r\n                      width: 100,\r\n                    }}\r\n                    onClick={() => handleVote(3)}>\r\n                    弃权\r\n                  </Button>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        )\r\n      }\r\n    </div>\r\n  )\r\n}\r\n"],"names":["useState","proposals","setProposals","total","setTotal","navigate","useNavigate","useParams","id","handle","getDetailData","proposalsApi","res","handleVote","type","parseInt","then","message","useEffect","yes_votes","no_votes","abstained_votes","className","variant","sx","width","onClick","title","is_resolved","truncateMiddle","proposer","dangerouslySetInnerHTML","__html","description","dayjs","start_time","format","end_time","percentage","style","disabled"],"sourceRoot":""}